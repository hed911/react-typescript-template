{"ast":null,"code":"var _jsxFileName = \"/Users/eduardoescobar/proyectos/own/hedu911-template/src/containers/Services/Services.tsx\";\nimport React, { useState, useEffect, useReducer } from \"react\";\nimport TableFilters from \"../../components/QueryView/TableFilters/TableFilters\";\nimport DynamicTable from \"../../components/QueryView/DynamicTable/DynamicTable\";\nimport TablePagination from \"../../components/QueryView/TablePagination/TablePagination\";\nimport DynamicForm from \"../../components/QueryView/DynamicForm/DynamicForm\";\nimport useHttp from \"../../hooks/http\";\nimport styles from \"./Services.module.css\";\n\nconst Services = ({}) => {\n  let tableHeaders = [\"Id\", \"Estado\", \"Tipo\", \"Categoria\", \"Empresa Asignada\", \"Solicitante\", \"Fecha\"];\n  const actions = {\n    edit: {\n      theClass: \"btn btn-primary\",\n      label: \"Editar\"\n    },\n    aprobe: {\n      theClass: \"btn btn-warning\",\n      label: \"Aprobar\"\n    },\n    delete: {\n      theClass: \"btn btn-danger\",\n      label: \"Borrar\"\n    }\n  };\n  const initialFilterElements = [{\n    name: \"id\",\n    type: \"text\",\n    placeholder: \"Id\",\n    value: \"\"\n  }, {\n    name: \"numero_documento\",\n    type: \"text\",\n    placeholder: \"Numero de documento\",\n    value: \"\"\n  }, {\n    name: \"primer_nombre\",\n    type: \"text\",\n    placeholder: \"Primer nombre\",\n    upCase: true,\n    value: \"\"\n  }, {\n    name: \"primer_apellido\",\n    type: \"text\",\n    placeholder: \"Primer apellido\",\n    upCase: true,\n    value: \"\"\n  }, {\n    name: \"fecha_inicio\",\n    type: \"date\",\n    placeholder: \"Fecha inicio\",\n    value: \"\"\n  }, {\n    name: \"fecha_fin\",\n    type: \"date\",\n    placeholder: \"Fecha fin\",\n    value: \"\"\n  }, {\n    name: \"estado\",\n    type: \"select\",\n    placeholder: \"Estado\",\n    items: [{\n      key: \"1\",\n      value: \"Pendiente\"\n    }, {\n      key: \"2\",\n      value: \"Aprobado\"\n    }, {\n      key: \"3\",\n      value: \"Rechazado\"\n    }],\n    selectedItemKey: \"\"\n  }, {\n    name: \"tipo\",\n    type: \"select\",\n    placeholder: \"Tipo\",\n    items: [{\n      key: \"1\",\n      value: \"Medico\"\n    }, {\n      key: \"2\",\n      value: \"Enfermera\"\n    }, {\n      key: \"3\",\n      value: \"Jefe\"\n    }],\n    selectedItemKey: \"\"\n  }, {\n    name: \"buscar\",\n    type: \"submit\",\n    placeholder: \"Buscar\",\n    value: \"Buscar\",\n    classes: [\"btn\", \"btn-primary\"]\n  }, {\n    name: \"exportar_v1\",\n    type: \"submit\",\n    placeholder: \"Exportar V1\",\n    value: \"Exportar V1\",\n    classes: [\"btn\", \"btn-warning\"]\n  }, {\n    name: \"exportar_v2\",\n    type: \"submit\",\n    placeholder: \"Exportar V2\",\n    value: \"Exportar V2\",\n    classes: [\"btn\", \"btn-warning\"]\n  }];\n  const {\n    isLoading,\n    error,\n    data,\n    sendRequest,\n    reqExtra,\n    reqIdentifer,\n    clear\n  } = useHttp();\n\n  let actionTriggered = (id, action) => {\n    alert(`number:${id}, action:${action}`);\n  };\n\n  let pageChanged = (page, step) => {\n    setCurrentPage(page);\n    setCurrentStep(step); //(`page=${page} and step=${step}`);\n\n    fetchData(page);\n  };\n\n  const filterActionTriggered = action => {\n    if (action === \"buscar\") {\n      fetchData();\n    } else {\n      alert(currentPage);\n    }\n  };\n\n  const valueChanged = (name, value) => {\n    let updatedFilterElements = [...filterElements];\n    updatedFilterElements.forEach(function (item) {\n      if (item.name == name) {\n        if (item.type == \"text\" || item.type == \"date\" || item.type == \"number\") {\n          item.value = value;\n        } else {\n          if (item.type == \"select\") {\n            item.selectedItemKey = value;\n          }\n        }\n      }\n    });\n    setFilterElements(updatedFilterElements);\n  };\n\n  const reducer = (currentFetchedData, action) => {\n    switch (action.type) {\n      case \"SET\":\n        return action.data;\n\n      default:\n        throw new Error(\"Should not get there!\");\n    }\n  };\n\n  const [fetchedData, dispatch] = useReducer(reducer, Array()); //const [fetchedData, setFetchedData] = useState<Array<TableData>>([]);\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [currentStep, setCurrentStep] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [filterElements, setFilterElements] = useState(initialFilterElements);\n  useEffect(() => {\n    // Only runs once\n    fetchData();\n  }, []);\n  useEffect(() => {\n    // Run everytime the useHttp hook is loading, retreiving data or retreiving some error\n    if (!isLoading && !error && reqIdentifer === \"SET\") {\n      let myData = [];\n      setTotalPages(data.total_pages);\n      data.items.forEach(function (item) {\n        let actions = [\"edit\"];\n\n        if (item.categoria_enum === 1) {\n          actions.push(\"aprobe\");\n          actions.push(\"delete\");\n        }\n\n        myData.push({\n          id: item.id,\n          contents: [item.id, item.estado, item.tipo, item.categoria, item.empresa_asignada, item.solicitante, item.fecha],\n          actions: actions\n        });\n      });\n      dispatch({\n        type: \"SET\",\n        data: myData\n      });\n    }\n  }, [data, reqExtra, reqIdentifer, isLoading, error]);\n\n  let fetchData = (page = 1) => {\n    const params = filterParamsUrl();\n    sendRequest(`http://localhost:4000/v1/services?page=${page}&size=${10}&${params}`, \"GET\", null, null, \"SET\");\n  };\n\n  const filterParams = () => {\n    const result = [];\n    filterElements.forEach(function (item) {\n      if (item.type == \"text\" || item.type == \"date\") {\n        result.push({\n          key: item.name,\n          value: item.value\n        });\n      } else {\n        if (item.type == \"select\") {\n          result.push({\n            key: item.name,\n            value: item.selectedItemKey\n          });\n        }\n      }\n    });\n    return result;\n  };\n\n  const filterParamsUrl = () => {\n    let result = [];\n    filterParams().filter(i => i.value !== \"\").forEach(function (item) {\n      result.push(`${item.key}=${encodeURIComponent(item.value)}`);\n    });\n    return result.join(\"&\");\n  };\n\n  let table = null;\n  let pagination = /*#__PURE__*/React.createElement(TablePagination, {\n    step: currentStep,\n    numbersShown: 10,\n    currentPage: currentPage,\n    totalPages: totalPages,\n    pageChanged: (page, step) => pageChanged(page, step),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 5\n    }\n  });\n\n  if (!isLoading && !error && fetchedData.length === 0) {\n    table = /*#__PURE__*/React.createElement(\"div\", {\n      className: [\"container-fluid\", styles.fullheight].join(\" \"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: [\"jumbotron\", \"jumbotron-fluid\", styles.fullheight].join(\" \"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-10x fa-file-upload\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"display-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 15\n      }\n    }, \"No se encontraron datos\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 15\n      }\n    }, \"No existen registros para los filtros de consulta seleccionados, por favor intente con otros filtros\")))));\n  } else {\n    if (isLoading && !error) {\n      table = /*#__PURE__*/React.createElement(\"div\", {\n        className: [\"container-fluid\", styles.fullheight].join(\" \"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: [\"jumbotron\", \"jumbotron-fluid\", styles.fullheight].join(\" \"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-10x fa-file-upload\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"display-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 17\n        }\n      }, \"Cargando ...\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"spinner-border text-warning\",\n        role: \"status\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"sr-only\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 19\n        }\n      }, \"Loading...\"))))));\n    }\n\n    if (!isLoading && error) {\n      table = /*#__PURE__*/React.createElement(\"div\", {\n        className: [\"container-fluid\", styles.fullheight].join(\" \"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: [\"jumbotron\", \"jumbotron-fluid\", styles.fullheight].join(\" \"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-10x fa-file-upload\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"h3\", {\n        style: {\n          color: \"red\"\n        },\n        className: \"display-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 17\n        }\n      }, \"Ocurri\\xF3 un problema\"), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 17\n        }\n      }, \"Por favor vuelva a intentar o contactese con nuestros administradores\")))));\n    }\n\n    if (!isLoading && !error) {\n      table = /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"table-responsive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(DynamicTable, {\n        headers: tableHeaders,\n        data: fetchedData,\n        actions: actions,\n        actionTriggered: actionTriggered,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 13\n        }\n      }), pagination));\n    }\n  } // ------------------------------------------------------------------- NEW RECORD --\n\n\n  const newRecordInitialElements = [{\n    displayName: \"Primer nombre\",\n    name: \"primer_nombre\",\n    type: \"text\",\n    placeholder: \"\",\n    value: \"\",\n    required: true\n  }, {\n    displayName: \"Segundo nombre\",\n    name: \"segundo_nombre\",\n    type: \"text\",\n    placeholder: \"\",\n    value: \"\",\n    required: false\n  }, {\n    displayName: \"Primer apellido\",\n    name: \"primer_apellido\",\n    type: \"text\",\n    placeholder: \"\",\n    value: \"\",\n    required: true\n  }, {\n    displayName: \"Segundo apellido\",\n    name: \"segundo_apellido\",\n    type: \"text\",\n    placeholder: \"\",\n    value: \"\",\n    required: false\n  }, {\n    displayName: \"Edad\",\n    name: \"edad\",\n    min: 0,\n    max: 200,\n    type: \"number\",\n    placeholder: \"\",\n    value: \"\",\n    required: true\n  }, {\n    displayName: \"Estado civil\",\n    name: \"estado_civil\",\n    type: \"select\",\n    placeholder: \"Escoja una opcion\",\n    items: [{\n      key: \"1\",\n      value: \"Soltero\"\n    }, {\n      key: \"2\",\n      value: \"Casado\"\n    }, {\n      key: \"3\",\n      value: \"Union libre\"\n    }],\n    selectedItemKey: \"\",\n    required: true\n  }, {\n    displayName: \"Fecha nacimiento\",\n    name: \"fecha_nacimiento\",\n    type: \"date\",\n    placeholder: \"\",\n    value: \"\",\n    required: true\n  }, {\n    displayName: \"Observación\",\n    name: \"id\",\n    type: \"textarea\",\n    placeholder: \"Escriba aqui algo\",\n    value: \"\",\n    required: true\n  }];\n  const [showNewRecordForm, setShowNewRecordForm] = useState(true);\n  const [newRecordElements, setNewRecordElements] = useState(newRecordInitialElements);\n\n  const submittedNewRecordForm = () => {// HERE GOES THE HTTP LOGIC!!\n    //fetchData(currentPage);\n    //setShowNewRecordForm(false);\n  };\n\n  const newRecordFormValueChanged = (name, value) => {\n    let updatedNewRecordElements = [...newRecordElements];\n    updatedNewRecordElements.forEach(function (item) {\n      if (item.name == name) {\n        if (item.type == \"text\" || item.type == \"date\" || item.type == \"number\" || item.type == \"textarea\") {\n          item.value = value;\n        } else {\n          if (item.type == \"select\") {\n            item.selectedItemKey = value;\n          }\n        }\n      }\n    });\n    setNewRecordElements(updatedNewRecordElements);\n  };\n\n  const closeNewRecordForm = () => {\n    setShowNewRecordForm(false);\n  };\n\n  const newRecordForm = /*#__PURE__*/React.createElement(DynamicForm, {\n    elements: newRecordElements,\n    requestType: \"POST\",\n    title: \"Nuevo servicio\",\n    submitText: \"Crear registro\",\n    show: showNewRecordForm,\n    size: \"lg\",\n    handleClose: () => closeNewRecordForm(),\n    submitted: () => submittedNewRecordForm(),\n    valueChanged: (name, value) => newRecordFormValueChanged(name, value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 486,\n      columnNumber: 5\n    }\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 503,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 504,\n      columnNumber: 9\n    }\n  }, \"Consulta \", /*#__PURE__*/React.createElement(\"small\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 505,\n      columnNumber: 20\n    }\n  }, \"Servicios\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 507,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TableFilters, {\n    elements: filterElements,\n    actionTriggered: filterActionTriggered,\n    valueChanged: valueChanged,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 513,\n      columnNumber: 11\n    }\n  }, table))), newRecordForm);\n};\n\nexport default Services;","map":{"version":3,"sources":["/Users/eduardoescobar/proyectos/own/hedu911-template/src/containers/Services/Services.tsx"],"names":["React","useState","useEffect","useReducer","TableFilters","DynamicTable","TablePagination","DynamicForm","useHttp","styles","Services","tableHeaders","actions","edit","theClass","label","aprobe","delete","initialFilterElements","name","type","placeholder","value","upCase","items","key","selectedItemKey","classes","isLoading","error","data","sendRequest","reqExtra","reqIdentifer","clear","actionTriggered","id","action","alert","pageChanged","page","step","setCurrentPage","setCurrentStep","fetchData","filterActionTriggered","currentPage","valueChanged","updatedFilterElements","filterElements","forEach","item","setFilterElements","reducer","currentFetchedData","Error","fetchedData","dispatch","Array","currentStep","totalPages","setTotalPages","myData","total_pages","categoria_enum","push","contents","estado","tipo","categoria","empresa_asignada","solicitante","fecha","params","filterParamsUrl","filterParams","result","filter","i","encodeURIComponent","join","table","pagination","length","fullheight","color","newRecordInitialElements","displayName","required","min","max","showNewRecordForm","setShowNewRecordForm","newRecordElements","setNewRecordElements","submittedNewRecordForm","newRecordFormValueChanged","updatedNewRecordElements","closeNewRecordForm","newRecordForm"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useReducer } from \"react\";\n\nimport TableFilters from \"../../components/QueryView/TableFilters/TableFilters\";\nimport DynamicTable from \"../../components/QueryView/DynamicTable/DynamicTable\";\nimport TablePagination from \"../../components/QueryView/TablePagination/TablePagination\";\nimport DynamicForm, {\n  InputDescriptor,\n} from \"../../components/QueryView/DynamicForm/DynamicForm\";\nimport useHttp from \"../../hooks/http\";\nimport styles from \"./Services.module.css\";\ntype Props = {};\n\ninterface FilterElement {\n  name: string;\n  type: string;\n  placeholder: string;\n  value?: string;\n  upCase?: boolean;\n  items?: Array<UrlItem>;\n  selectedItemKey?: string;\n  classes?: Array<string>;\n}\n\ninterface TableData {\n  id: number;\n  contents: Array<string>;\n  actions: Array<string>;\n}\n\ninterface UrlItem {\n  key: string;\n  value: string;\n}\n\ninterface Action {\n  data: any | null;\n  type: string;\n}\n\nconst Services: React.FC<Props> = ({}) => {\n  let tableHeaders = [\n    \"Id\",\n    \"Estado\",\n    \"Tipo\",\n    \"Categoria\",\n    \"Empresa Asignada\",\n    \"Solicitante\",\n    \"Fecha\",\n  ];\n\n  const actions = {\n    edit: {\n      theClass: \"btn btn-primary\",\n      label: \"Editar\",\n    },\n    aprobe: {\n      theClass: \"btn btn-warning\",\n      label: \"Aprobar\",\n    },\n    delete: {\n      theClass: \"btn btn-danger\",\n      label: \"Borrar\",\n    },\n  };\n\n  const initialFilterElements = [\n    { name: \"id\", type: \"text\", placeholder: \"Id\", value: \"\" },\n    {\n      name: \"numero_documento\",\n      type: \"text\",\n      placeholder: \"Numero de documento\",\n      value: \"\",\n    },\n    {\n      name: \"primer_nombre\",\n      type: \"text\",\n      placeholder: \"Primer nombre\",\n      upCase: true,\n      value: \"\",\n    },\n    {\n      name: \"primer_apellido\",\n      type: \"text\",\n      placeholder: \"Primer apellido\",\n      upCase: true,\n      value: \"\",\n    },\n    {\n      name: \"fecha_inicio\",\n      type: \"date\",\n      placeholder: \"Fecha inicio\",\n      value: \"\",\n    },\n    {\n      name: \"fecha_fin\",\n      type: \"date\",\n      placeholder: \"Fecha fin\",\n      value: \"\",\n    },\n    {\n      name: \"estado\",\n      type: \"select\",\n      placeholder: \"Estado\",\n      items: [\n        { key: \"1\", value: \"Pendiente\" },\n        { key: \"2\", value: \"Aprobado\" },\n        { key: \"3\", value: \"Rechazado\" },\n      ],\n      selectedItemKey: \"\",\n    },\n    {\n      name: \"tipo\",\n      type: \"select\",\n      placeholder: \"Tipo\",\n      items: [\n        { key: \"1\", value: \"Medico\" },\n        { key: \"2\", value: \"Enfermera\" },\n        { key: \"3\", value: \"Jefe\" },\n      ],\n      selectedItemKey: \"\",\n    },\n    {\n      name: \"buscar\",\n      type: \"submit\",\n      placeholder: \"Buscar\",\n      value: \"Buscar\",\n      classes: [\"btn\", \"btn-primary\"],\n    },\n    {\n      name: \"exportar_v1\",\n      type: \"submit\",\n      placeholder: \"Exportar V1\",\n      value: \"Exportar V1\",\n      classes: [\"btn\", \"btn-warning\"],\n    },\n    {\n      name: \"exportar_v2\",\n      type: \"submit\",\n      placeholder: \"Exportar V2\",\n      value: \"Exportar V2\",\n      classes: [\"btn\", \"btn-warning\"],\n    },\n  ];\n\n  const {\n    isLoading,\n    error,\n    data,\n    sendRequest,\n    reqExtra,\n    reqIdentifer,\n    clear,\n  } = useHttp();\n\n  let actionTriggered = (id: number, action: string) => {\n    alert(`number:${id}, action:${action}`);\n  };\n\n  let pageChanged = (page: number, step: number) => {\n    setCurrentPage(page);\n    setCurrentStep(step);\n    //(`page=${page} and step=${step}`);\n    fetchData(page);\n  };\n  const filterActionTriggered = (action: string) => {\n    if (action === \"buscar\") {\n      fetchData();\n    } else {\n      alert(currentPage);\n    }\n  };\n  const valueChanged = (name: string, value: string) => {\n    let updatedFilterElements = [...filterElements];\n    updatedFilterElements.forEach(function (item: FilterElement) {\n      if (item.name == name) {\n        if (\n          item.type == \"text\" ||\n          item.type == \"date\" ||\n          item.type == \"number\"\n        ) {\n          item.value = value;\n        } else {\n          if (item.type == \"select\") {\n            item.selectedItemKey = value;\n          }\n        }\n      }\n    });\n    setFilterElements(updatedFilterElements);\n  };\n\n  const reducer = (currentFetchedData: Array<TableData>, action: Action) => {\n    switch (action.type) {\n      case \"SET\":\n        return action.data;\n      default:\n        throw new Error(\"Should not get there!\");\n    }\n  };\n\n  const [fetchedData, dispatch] = useReducer(reducer, Array<TableData>());\n  //const [fetchedData, setFetchedData] = useState<Array<TableData>>([]);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [currentStep, setCurrentStep] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [filterElements, setFilterElements] = useState<Array<FilterElement>>(\n    initialFilterElements\n  );\n\n  useEffect(() => {\n    // Only runs once\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    // Run everytime the useHttp hook is loading, retreiving data or retreiving some error\n    if (!isLoading && !error && reqIdentifer === \"SET\") {\n      let myData: Array<TableData> = [];\n      setTotalPages(data.total_pages);\n      data.items.forEach(function (item: any) {\n        let actions = [\"edit\"];\n        if (item.categoria_enum === 1) {\n          actions.push(\"aprobe\");\n          actions.push(\"delete\");\n        }\n        myData.push({\n          id: item.id,\n          contents: [\n            item.id,\n            item.estado,\n            item.tipo,\n            item.categoria,\n            item.empresa_asignada,\n            item.solicitante,\n            item.fecha,\n          ],\n          actions: actions,\n        });\n      });\n      dispatch({ type: \"SET\", data: myData });\n    }\n  }, [data, reqExtra, reqIdentifer, isLoading, error]);\n\n  let fetchData = (page: number = 1) => {\n    const params = filterParamsUrl();\n    sendRequest(\n      `http://localhost:4000/v1/services?page=${page}&size=${10}&${params}`,\n      \"GET\",\n      null,\n      null,\n      \"SET\"\n    );\n  };\n\n  const filterParams = (): Array<UrlItem> => {\n    const result: Array<UrlItem> = [];\n    filterElements.forEach(function (item: FilterElement) {\n      if (item.type == \"text\" || item.type == \"date\") {\n        result.push({ key: item.name, value: item.value! });\n      } else {\n        if (item.type == \"select\") {\n          result.push({ key: item.name, value: item.selectedItemKey! });\n        }\n      }\n    });\n    return result;\n  };\n\n  const filterParamsUrl = (): string => {\n    let result: Array<string> = [];\n    filterParams()\n      .filter((i) => i.value !== \"\")\n      .forEach(function (item: UrlItem) {\n        result.push(`${item.key}=${encodeURIComponent(item.value)}`);\n      });\n    return result.join(\"&\");\n  };\n\n  let table = null;\n  let pagination = (\n    <TablePagination\n      step={currentStep}\n      numbersShown={10}\n      currentPage={currentPage}\n      totalPages={totalPages}\n      pageChanged={(page, step) => pageChanged(page, step)}\n    />\n  );\n\n  if (!isLoading && !error && fetchedData.length === 0) {\n    table = (\n      <div className={[\"container-fluid\", styles.fullheight].join(\" \")}>\n        <div\n          className={[\"jumbotron\", \"jumbotron-fluid\", styles.fullheight].join(\n            \" \"\n          )}\n        >\n          <div className=\"container\">\n            <div className=\"text-center\">\n              <i className=\"fas fa-10x fa-file-upload\"></i>\n              <h2 className=\"display-4\">No se encontraron datos</h2>\n              <p>\n                No existen registros para los filtros de consulta seleccionados,\n                por favor intente con otros filtros\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  } else {\n    if (isLoading && !error) {\n      table = (\n        <div className={[\"container-fluid\", styles.fullheight].join(\" \")}>\n          <div\n            className={[\"jumbotron\", \"jumbotron-fluid\", styles.fullheight].join(\n              \" \"\n            )}\n          >\n            <div className=\"container\">\n              <div className=\"text-center\">\n                <i className=\"fas fa-10x fa-file-upload\"></i>\n                <h3 className=\"display-4\">Cargando ...</h3>\n                <div className=\"spinner-border text-warning\" role=\"status\">\n                  <span className=\"sr-only\">Loading...</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    }\n    if (!isLoading && error) {\n      table = (\n        <div className={[\"container-fluid\", styles.fullheight].join(\" \")}>\n          <div\n            className={[\"jumbotron\", \"jumbotron-fluid\", styles.fullheight].join(\n              \" \"\n            )}\n          >\n            <div className=\"container\">\n              <div className=\"text-center\">\n                <i className=\"fas fa-10x fa-file-upload\"></i>\n                <h3 style={{ color: \"red\" }} className=\"display-4\">\n                  Ocurrió un problema\n                </h3>\n                <p>\n                  Por favor vuelva a intentar o contactese con nuestros\n                  administradores\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    }\n    if (!isLoading && !error) {\n      table = (\n        <div className=\"container-fluid\">\n          <div className=\"table-responsive\">\n            <DynamicTable\n              headers={tableHeaders}\n              data={fetchedData}\n              actions={actions}\n              actionTriggered={actionTriggered}\n            />\n            {pagination}\n          </div>\n        </div>\n      );\n    }\n  }\n\n  // ------------------------------------------------------------------- NEW RECORD --\n  const newRecordInitialElements: Array<InputDescriptor> = [\n    {\n      displayName: \"Primer nombre\",\n      name: \"primer_nombre\",\n      type: \"text\",\n      placeholder: \"\",\n      value: \"\",\n      required: true,\n    },\n    {\n      displayName: \"Segundo nombre\",\n      name: \"segundo_nombre\",\n      type: \"text\",\n      placeholder: \"\",\n      value: \"\",\n      required: false,\n    },\n    {\n      displayName: \"Primer apellido\",\n      name: \"primer_apellido\",\n      type: \"text\",\n      placeholder: \"\",\n      value: \"\",\n      required: true,\n    },\n    {\n      displayName: \"Segundo apellido\",\n      name: \"segundo_apellido\",\n      type: \"text\",\n      placeholder: \"\",\n      value: \"\",\n      required: false,\n    },\n    {\n      displayName: \"Edad\",\n      name: \"edad\",\n      min: 0,\n      max: 200,\n      type: \"number\",\n      placeholder: \"\",\n      value: \"\",\n      required: true,\n    },\n    {\n      displayName: \"Estado civil\",\n      name: \"estado_civil\",\n      type: \"select\",\n      placeholder: \"Escoja una opcion\",\n      items: [\n        { key: \"1\", value: \"Soltero\" },\n        { key: \"2\", value: \"Casado\" },\n        { key: \"3\", value: \"Union libre\" },\n      ],\n      selectedItemKey: \"\",\n      required: true,\n    },\n    {\n      displayName: \"Fecha nacimiento\",\n      name: \"fecha_nacimiento\",\n      type: \"date\",\n      placeholder: \"\",\n      value: \"\",\n      required: true,\n    },\n    {\n      displayName: \"Observación\",\n      name: \"id\",\n      type: \"textarea\",\n      placeholder: \"Escriba aqui algo\",\n      value: \"\",\n      required: true,\n    },\n  ];\n\n  const [showNewRecordForm, setShowNewRecordForm] = useState(true);\n  const [newRecordElements, setNewRecordElements] = useState<\n    Array<InputDescriptor>\n  >(newRecordInitialElements);\n\n  const submittedNewRecordForm = () => {\n    // HERE GOES THE HTTP LOGIC!!\n    //fetchData(currentPage);\n    //setShowNewRecordForm(false);\n  };\n\n  const newRecordFormValueChanged = (name: string, value: string) => {\n    let updatedNewRecordElements = [...newRecordElements];\n    updatedNewRecordElements.forEach(function (item: InputDescriptor) {\n      if (item.name == name) {\n        if (\n          item.type == \"text\" ||\n          item.type == \"date\" ||\n          item.type == \"number\" ||\n          item.type == \"textarea\"\n        ) {\n          item.value = value;\n        } else {\n          if (item.type == \"select\") {\n            item.selectedItemKey = value;\n          }\n        }\n      }\n    });\n    setNewRecordElements(updatedNewRecordElements);\n  };\n\n  const closeNewRecordForm = () => {\n    setShowNewRecordForm(false);\n  };\n\n  const newRecordForm = (\n    <DynamicForm\n      elements={newRecordElements}\n      requestType=\"POST\"\n      title=\"Nuevo servicio\"\n      submitText=\"Crear registro\"\n      show={showNewRecordForm}\n      size=\"lg\"\n      handleClose={() => closeNewRecordForm()}\n      submitted={() => submittedNewRecordForm()}\n      valueChanged={(name: string, value: string) =>\n        newRecordFormValueChanged(name, value)\n      }\n    />\n  );\n\n  return (\n    <>\n      <div className=\"container-fluid\">\n        <h1>\n          Consulta <small>Servicios</small>\n        </h1>\n        <div className=\"row\">\n          <TableFilters\n            elements={filterElements}\n            actionTriggered={filterActionTriggered}\n            valueChanged={valueChanged}\n          />\n          <div className=\"col-10\">{table}</div>\n        </div>\n      </div>\n      {newRecordForm}\n    </>\n  );\n};\n\nexport default Services;\n"]},"metadata":{},"sourceType":"module"}